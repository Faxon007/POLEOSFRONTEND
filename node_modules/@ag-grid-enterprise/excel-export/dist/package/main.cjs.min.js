var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},__copyProps=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of __getOwnPropNames(t))!__hasOwnProp.call(e,o)&&o!==r&&__defProp(e,o,{get:()=>t[o],enumerable:!(a=__getOwnPropDesc(t,o))||a.enumerable});return e},__toCommonJS=e=>__copyProps(__defProp({},"__esModule",{value:!0}),e),main_exports={};__export(main_exports,{ExcelExportModule:()=>ExcelExportModule,exportMultipleSheetsAsExcel:()=>exportMultipleSheetsAsExcel,getMultipleSheetsAsExcel:()=>getMultipleSheetsAsExcel}),module.exports=__toCommonJS(main_exports);var import_core10=require("@ag-grid-community/core"),import_csv_export4=require("@ag-grid-community/csv-export"),import_core11=require("@ag-grid-enterprise/core"),import_core8=require("@ag-grid-community/core"),import_csv_export3=require("@ag-grid-community/csv-export"),import_core7=require("@ag-grid-community/core"),import_csv_export2=require("@ag-grid-community/csv-export"),import_core=require("@ag-grid-community/core"),import_csv_export=require("@ag-grid-community/csv-export"),INCH_TO_EMU=9525,numberFormatMap={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},pointsToPixel=e=>Math.round(e*96/72),pixelsToEMU=e=>Math.ceil(e*INCH_TO_EMU),getFontFamilyId=e=>{if(e===void 0)return;const r=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(r,0)},getHeightFromProperty=(e,t)=>{if(!t)return;let r;return typeof t=="number"?r=t:r=t({rowIndex:e}),r},setExcelImageTotalWidth=(e,t)=>{const{colSpan:r,column:a}=e.position;if(e.width)if(r){const o=t.slice(a-1,a+r-1);let n=0;for(let s=0;s<o.length;s++){const i=o[s].getActualWidth();if(e.width<n+i){e.position.colSpan=s+1,e.totalWidth=e.width,e.width=e.totalWidth-n;break}n+=i}}else e.totalWidth=e.width},setExcelImageTotalHeight=(e,t)=>{const{rowSpan:r,row:a}=e.position;if(e.height)if(r){let o=0,n=0;for(let s=a;s<a+r;s++){const i=pointsToPixel(getHeightFromProperty(s,t)||20);if(e.height<o+i){e.position.rowSpan=n+1,e.totalHeight=e.height,e.height=e.totalHeight-o;break}o+=i,n++}}else e.totalHeight=e.height},createXmlPart=(e,t)=>{const r=import_csv_export.XmlFactory.createHeader({encoding:"UTF-8",standalone:"yes"}),a=import_csv_export.XmlFactory.createXml(e);return t?a:`${r}${a}`},getExcelColumnName=e=>{const a=String.fromCharCode,o=Math.floor(e/26),n=e%26;return!o||e===26?a(65+e-1):n?o<26?a(65+o-1)+a(65+n-1):getExcelColumnName(o)+a(65+n-1):getExcelColumnName(o-1)+"Z"},replaceInvisibleCharacters=e=>{if(e==null)return null;let t="";for(let r=0;r<e.length;r++){const a=e.charCodeAt(r);if(a>=0&&a<=31&&a!==10){const s=`_x${a.toString(16).toUpperCase().padStart(4,"0")}_`;t+=s}else t+=e[r]}return t},buildSharedString=e=>{const t=[];for(const r of e.keys()){const a=r.toString(),o={name:"t",textNode:(0,import_core._escapeString)(replaceInvisibleCharacters(a),!1)};a.trim().length!==a.length&&(o.properties={rawMap:{"xml:space":"preserve"}}),t.push({name:"si",children:[o]})}return t},import_core5=require("@ag-grid-community/core"),contentTypeFactory={getTemplate(e){const{name:t,ContentType:r,Extension:a,PartName:o}=e;return{name:t,properties:{rawMap:{Extension:a,PartName:o,ContentType:r}}}}},contentType_default=contentTypeFactory,_normaliseImageExtension=e=>e==="jpg"?"jpeg":e,contentTypesFactory={getTemplate(e){const t=new Array(e).fill(void 0).map((c,m)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:`/xl/worksheets/sheet${m+1}.xml`})),r=ExcelXlsxFactory.worksheetImages.size,a=ExcelXlsxFactory.worksheetHeaderFooterImages.size,o=ExcelXlsxFactory.worksheetDataTables.size,n={};ExcelXlsxFactory.workbookImageIds.forEach(c=>{n[_normaliseImageExtension(c.type)]=!0});const s=new Array(r).fill(void 0).map((c,m)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:`/xl/drawings/drawing${m+1}.xml`})),i=new Array(o).fill(void 0).map((c,m)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",PartName:`/xl/tables/${ExcelXlsxFactory.getTableNameFromIndex(m)}.xml`})),l=Object.keys(n).map(c=>({name:"Default",ContentType:`image/${c}`,Extension:c}));a&&l.push({name:"Default",Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"});const p=[...l,{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"},...t,{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"},...s,...i,{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}].map(c=>contentType_default.getTemplate(c));return{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:p}}},contentTypes_default=contentTypesFactory,coreFactory={getTemplate(e){const r=new Date().toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:r},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:r}]}}},core_default=coreFactory,getAnchor=(e,t)=>({name:`xdr:${e}`,children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}),getExt=e=>{const t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},getNvPicPr=(e,t)=>({name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:e.altText!=null?e.altText:void 0}},children:[getExt(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}),getColorDetails=e=>{if(!e.saturation&&!e.tint)return;const t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:e.saturation*1e3}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:e.tint*1e3}}}),t},getDuoTone=(e,t)=>({name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:e.color}},children:getColorDetails(e)},{name:"a:srgbClr",properties:{rawMap:{val:t.color}},children:getColorDetails(t)}]}),getBlipFill=(e,t)=>{let r;if(e.transparency){const a=Math.min(Math.max(e.transparency,0),100);r=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(a*1e3)}}}]}if(e.recolor)switch(r||(r=[]),e.recolor.toLocaleLowerCase()){case"grayscale":r.push({name:"a:grayscl"});break;case"sepia":r.push(getDuoTone({color:"black"},{color:"D9C3A5",tint:50,saturation:180}));break;case"washout":r.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}});break;default:}return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":`rId${t}`,"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:r},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},getSpPr=(e,t)=>{const r={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};if(e.rotation){const n=e.rotation;r.properties={rawMap:{rot:Math.min(Math.max(n,0),360)*6e4}}}return{name:"xdr:spPr",children:[r,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},getImageBoxSize=e=>{e.fitCell=!!e.fitCell||!e.width||!e.height;const{position:t={},fitCell:r,width:a=0,height:o=0,totalHeight:n,totalWidth:s}=e,{offsetX:i=0,offsetY:l=0,row:p=1,rowSpan:c=1,column:m=1,colSpan:h=1}=t;return{from:{row:p-1,col:m-1,offsetX:pixelsToEMU(i),offsetY:pixelsToEMU(l)},to:{row:p-1+(r?1:c-1),col:m-1+(r?1:h-1),offsetX:pixelsToEMU(a+i),offsetY:pixelsToEMU(o+l)},height:pixelsToEMU(n||o),width:pixelsToEMU(s||a)}},getPicture=(e,t,r,a)=>({name:"xdr:pic",children:[getNvPicPr(e,t+1),getBlipFill(e,r+1),getSpPr(e,a)]}),drawingFactory={getTemplate(e){const{sheetIndex:t}=e,r=ExcelXlsxFactory.worksheetImages.get(t),a=ExcelXlsxFactory.worksheetImageIds.get(t),o=r.map((n,s)=>{const i=getImageBoxSize(n);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[getAnchor("from",i.from),getAnchor("to",i.to),getPicture(n,s,a.get(n.id).index,i),{name:"xdr:clientData"}]}});return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:o}}},drawing_default=drawingFactory,relationshipFactory={getTemplate(e){const{Id:t,Type:r,Target:a}=e;return{name:"Relationship",properties:{rawMap:{Id:t,Type:r,Target:a}}}}},relationship_default=relationshipFactory,relationshipsFactory={getTemplate(e){const t=e.map(r=>relationship_default.getTemplate(r));return{name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:t}}},relationships_default=relationshipsFactory,sharedStrings={getTemplate(e){return{name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.size,uniqueCount:e.size}},children:buildSharedString(e)}}},sharedStrings_default=sharedStrings,getWeightName=e=>{switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}},mappedBorderNames={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot",Continuous:"Continuous"},mediumBorders=["Dashed","DashDot","DashDotDot"],colorMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},horizontalAlignmentMap={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},verticalAlignmentMap={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},convertLegacyPattern=e=>e?colorMap[e]||e:"none",convertLegacyColor=e=>e==null?e:(e.charAt(0)==="#"&&(e=e.substring(1)),e.length===6?"FF"+e:e),convertLegacyBorder=(e,t)=>{if(!e)return"thin";const r=getWeightName(t);if(e==="Continuous")return r;const a=mappedBorderNames[e];return r==="medium"&&mediumBorders.some(o=>o===a)?`medium${a}`:`${a.charAt(0).toLowerCase()}${a.substring(1)}`},convertLegacyHorizontalAlignment=e=>horizontalAlignmentMap[e]||"general",convertLegacyVerticalAlignment=e=>verticalAlignmentMap[e]||void 0,getBorderColor=e=>({name:"color",properties:{rawMap:{rgb:convertLegacyColor(e||"#000000")}}}),borderFactory={getTemplate(e){const{left:t,right:r,top:a,bottom:o,diagonal:n}=e,s=t?[getBorderColor(t.color)]:void 0,i=r?[getBorderColor(r.color)]:void 0,l=a?[getBorderColor(a.color)]:void 0,p=o?[getBorderColor(o.color)]:void 0,c=n?[getBorderColor(n.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:s},{name:"right",properties:{rawMap:{style:r&&r.style}},children:i},{name:"top",properties:{rawMap:{style:a&&a.style}},children:l},{name:"bottom",properties:{rawMap:{style:o&&o.style}},children:p},{name:"diagonal",properties:{rawMap:{style:n&&n.style}},children:c}]}}},border_default=borderFactory,bordersFactory={getTemplate(e){return{name:"borders",properties:{rawMap:{count:e.length}},children:e.map(t=>border_default.getTemplate(t))}}},borders_default=bordersFactory,getReadingOrderId=e=>{const r=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(r,0)},alignmentFactory={getTemplate(e){const{horizontal:t,indent:r,readingOrder:a,rotate:o,shrinkToFit:n,vertical:s,wrapText:i}=e;return{name:"alignment",properties:{rawMap:{horizontal:t&&convertLegacyHorizontalAlignment(t),indent:r,readingOrder:a&&getReadingOrderId(a),textRotation:o,shrinkToFit:n,vertical:s&&convertLegacyVerticalAlignment(s),wrapText:i}}}}},alignment_default=alignmentFactory,protectionFactory={getTemplate(e){const t=e.protected===!1?0:1;return{name:"protection",properties:{rawMap:{hidden:e.hideFormula===!0?1:0,locked:t}}}}},protection_default=protectionFactory,xfFactory={getTemplate(e){const{alignment:t,borderId:r,fillId:a,fontId:o,numFmtId:n,protection:s,quotePrefix:i,xfId:l}=e,p=[];return t&&p.push(alignment_default.getTemplate(t)),s&&p.push(protection_default.getTemplate(s)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:s?1:void 0,applyBorder:r?1:void 0,applyFill:a?1:void 0,borderId:r,fillId:a,applyFont:o?1:void 0,fontId:o,applyNumberFormat:n?1:void 0,numFmtId:n,quotePrefix:i?1:void 0,xfId:l}},children:p.length?p:void 0}}},xf_default=xfFactory,cellStylesXfsFactory={getTemplate(e){return{name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map(t=>xf_default.getTemplate(t))}}},cellStyleXfs_default=cellStylesXfsFactory,borderFactory2={getTemplate(e){const{builtinId:t,name:r,xfId:a}=e;return{name:"cellStyle",properties:{rawMap:{builtinId:t,name:r,xfId:a}}}}},cellStyle_default=borderFactory2,cellStylesFactory={getTemplate(e){return{name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map(t=>cellStyle_default.getTemplate(t))}}},cellStyles_default=cellStylesFactory,cellXfsFactory={getTemplate(e){return{name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map(t=>xf_default.getTemplate(t))}}},cellXfs_default=cellXfsFactory,fillFactory={getTemplate(e){const{patternType:t,fgTheme:r,fgTint:a,fgRgb:o,bgRgb:n,bgIndexed:s}=e,i={name:"patternFill",properties:{rawMap:{patternType:t}}};return(r||a||o)&&(i.children=[{name:"fgColor",properties:{rawMap:{theme:r,tint:a,rgb:o}}}]),(s||n)&&(i.children||(i.children=[]),i.children.push({name:"bgColor",properties:{rawMap:{indexed:s,rgb:n}}})),{name:"fill",children:[i]}}},fill_default=fillFactory,fillsFactory={getTemplate(e){return{name:"fills",properties:{rawMap:{count:e.length}},children:e.map(t=>fill_default.getTemplate(t))}}},fills_default=fillsFactory,fontFactory={getTemplate(e){const{size:t,colorTheme:r,color:a="FF000000",fontName:o="Calibri",family:n,scheme:s,italic:i,bold:l,strikeThrough:p,outline:c,shadow:m,underline:h,verticalAlign:u}=e,d=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:r,rgb:a}}},{name:"name",properties:{rawMap:{val:o}}}];return n&&d.push({name:"family",properties:{rawMap:{val:n}}}),s&&d.push({name:"scheme",properties:{rawMap:{val:s}}}),i&&d.push({name:"i"}),l&&d.push({name:"b"}),p&&d.push({name:"strike"}),c&&d.push({name:"outline"}),m&&d.push({name:"shadow"}),h&&d.push({name:"u",properties:{rawMap:{val:h}}}),u&&d.push({name:"vertAlign",properties:{rawMap:{val:u}}}),{name:"font",children:d}}},font_default=fontFactory,fontsFactory={getTemplate(e){return{name:"fonts",properties:{rawMap:{count:e.length}},children:e.map(t=>font_default.getTemplate(t))}}},fonts_default=fontsFactory,import_core2=require("@ag-grid-community/core");function prepareString(e){const t=e.split(/(\[[^\]]*\])/);for(let r=0;r<t.length;r++){let a=t[r];a.length&&(a.startsWith("[")||(a=a.replace(/\$/g,'"$"')),t[r]=(0,import_core2._escapeString)(a))}return t.join("")}var numberFormatFactory={getTemplate(e){let{formatCode:t,numFmtId:r}=e;return t.length&&(t=prepareString(t)),{name:"numFmt",properties:{rawMap:{formatCode:t,numFmtId:r}}}}},numberFormat_default=numberFormatFactory,numberFormatsFactory={getTemplate(e){return{name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map(t=>numberFormat_default.getTemplate(t))}}},numberFormats_default=numberFormatsFactory,stylesMap,registeredNumberFmts,registeredFonts,registeredFills,registeredBorders,registeredCellStyleXfs,registeredCellXfs,registeredCellStyles,currentSheet,getStyleName=(e,t)=>(e.indexOf("mixedStyle")!==-1&&t>1&&(e+=`_${t}`),e),resetStylesheetValues=()=>{stylesMap={base:0},registeredNumberFmts=[],registeredFonts=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],registeredFills=[{patternType:"none"},{patternType:"gray125"}],registeredBorders=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],registeredCellStyleXfs=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],registeredCellXfs=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],registeredCellStyles=[{builtinId:0,name:"Normal",xfId:0}]},registerFill=e=>{const t=convertLegacyPattern(e.pattern),r=convertLegacyColor(e.color),a=convertLegacyColor(e.patternColor);let o=registeredFills.findIndex(n=>{const{patternType:s,fgRgb:i,bgRgb:l}=n;return!(s!=t||i!=r||l!=a)});return o===-1&&(o=registeredFills.length,registeredFills.push({patternType:t,fgRgb:r,bgRgb:a})),o},registerNumberFmt=e=>{if(numberFormatMap[e])return numberFormatMap[e];let t=registeredNumberFmts.findIndex(r=>r.formatCode===e);return t===-1?(t=registeredNumberFmts.length+164,registeredNumberFmts.push({formatCode:e,numFmtId:t})):t=registeredNumberFmts[t].numFmtId,t},registerBorders=e=>{const{borderBottom:t,borderTop:r,borderLeft:a,borderRight:o}=e;let n,s,i,l,p,c,m,h;a&&(i=convertLegacyBorder(a.lineStyle,a.weight),m=convertLegacyColor(a.color)),o&&(l=convertLegacyBorder(o.lineStyle,o.weight),h=convertLegacyColor(o.color)),t&&(n=convertLegacyBorder(t.lineStyle,t.weight),p=convertLegacyColor(t.color)),r&&(s=convertLegacyBorder(r.lineStyle,r.weight),c=convertLegacyColor(r.color));let u=registeredBorders.findIndex(d=>{const{left:f,right:x,top:g,bottom:v}=d;if(!f&&(i||m)||!x&&(l||h)||!g&&(s||c)||!v&&(n||p))return!1;const{style:w,color:y}=f||{},{style:C,color:T}=x||{},{style:S,color:M}=g||{},{style:F,color:I}=v||{};return!(w!=i||y!=m||C!=l||T!=h||S!=s||M!=c||F!=n||I!=p)});return u===-1&&(u=registeredBorders.length,registeredBorders.push({left:{style:i,color:m},right:{style:l,color:h},top:{style:s,color:c},bottom:{style:n,color:p},diagonal:{style:void 0,color:void 0}})),u},registerFont=e=>{const{fontName:t="Calibri",color:r,size:a,bold:o,italic:n,outline:s,shadow:i,strikeThrough:l,underline:p,family:c,verticalAlign:m}=e,h=convertLegacyColor(r),u=getFontFamilyId(c),d=p?p.toLocaleLowerCase():void 0,f=m?m.toLocaleLowerCase():void 0;let x=registeredFonts.findIndex(g=>!(g.fontName!=t||g.color!=h||g.size!=a||g.bold!=o||g.italic!=n||g.outline!=s||g.shadow!=i||g.strikeThrough!=l||g.underline!=d||g.verticalAlign!=f||g.family!=u));return x===-1&&(x=registeredFonts.length,registeredFonts.push({fontName:t,color:h,size:a,bold:o,italic:n,outline:s,shadow:i,strikeThrough:l,underline:d,verticalAlign:f,family:u?.toString()})),x},registerStyle=e=>{const{alignment:t,borders:r,font:a,interior:o,numberFormat:n,protection:s,quotePrefix:i}=e;let{id:l}=e,p=0,c=0,m=0,h=0;l&&(l=getStyleName(l,currentSheet),stylesMap[l]==null&&(o&&(p=registerFill(o)),r&&(c=registerBorders(r)),a&&(m=registerFont(a)),n&&(h=registerNumberFmt(n.format)),stylesMap[l]=registeredCellXfs.length,registeredCellXfs.push({alignment:t,borderId:c||0,fillId:p||0,fontId:m||0,numFmtId:h||0,protection:s,quotePrefix:i,xfId:0})))},stylesheetFactory={getTemplate(e){const t=numberFormats_default.getTemplate(registeredNumberFmts),r=fonts_default.getTemplate(registeredFonts.map(l=>({...l,size:l.size!=null?l.size:e}))),a=fills_default.getTemplate(registeredFills),o=borders_default.getTemplate(registeredBorders),n=cellStyleXfs_default.getTemplate(registeredCellStyleXfs),s=cellXfs_default.getTemplate(registeredCellXfs),i=cellStyles_default.getTemplate(registeredCellStyles);return resetStylesheetValues(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,r,a,o,n,s,i,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}}},getStyleId=(e,t)=>stylesMap[getStyleName(e,t)]||0,registerStyles=(e,t)=>{currentSheet=t,currentSheet===1&&resetStylesheetValues(),e.forEach(registerStyle)},stylesheet_default=stylesheetFactory,tableFactory={getTemplate(e,t){const{name:r,columns:a,rowCount:o,displayName:n,headerRowIndex:s,showRowStripes:i,showColumnStripes:l,showFilterButtons:p,highlightFirstColumn:c,highlightLastColumn:m}=e||{};if(!e||!r||!Array.isArray(a)||!a.length||!o)return{name:"table"};const h=a.map((w,y)=>({name:"filterColumn",properties:{rawMap:{colId:y.toString(),hiddenButton:p[y]?0:1}}})),u=s+1,d=(t+1).toString(),f=`A${u}`,x=`${String.fromCharCode(64+a.length)}${u+o}`,g=`${f}:${x}`,v=t?`${n}_${t+1}`:n;return{name:"table",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",name:r,displayName:v,ref:g,totalsRowShown:0,id:d}},children:[{name:"autoFilter",properties:{rawMap:{ref:g}},children:h},{name:"tableColumns",properties:{rawMap:{count:a.length}},children:a.map((w,y)=>({name:"tableColumn",properties:{rawMap:{id:(y+1).toString(),name:w,dataCellStyle:"Normal"}}}))},{name:"tableStyleInfo",properties:{rawMap:{name:"TableStyleLight1",showFirstColumn:c?1:0,showLastColumn:m?1:0,showRowStripes:i?1:0,showColumnStripes:l?1:0}}}]}}},table_default=tableFactory,getColorChildren=e=>{const[t,r,a,o]=e;return{name:`a:${t}`,children:[{name:`a:${r}`,properties:{rawMap:{val:a,lastClr:o}}}]}},colorScheme={getTemplate(){return{name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[getColorChildren(["dk1","sysClr","windowText","000000"]),getColorChildren(["lt1","sysClr","window","FFFFFF"]),getColorChildren(["dk2","srgbClr","44546A"]),getColorChildren(["lt2","srgbClr","E7E6E6"]),getColorChildren(["accent1","srgbClr","4472C4"]),getColorChildren(["accent2","srgbClr","ED7D31"]),getColorChildren(["accent3","srgbClr","A5A5A5"]),getColorChildren(["accent4","srgbClr","FFC000"]),getColorChildren(["accent5","srgbClr","5B9BD5"]),getColorChildren(["accent6","srgbClr","70AD47"]),getColorChildren(["hlink","srgbClr","0563C1"]),getColorChildren(["folHlink","srgbClr","954F72"])]}}},colorScheme_default=colorScheme,getFont=e=>{const[t,r,a,o]=e;return{name:`a:${t}`,properties:{rawMap:{script:a,typeface:r,panose:o}}}},fontScheme={getTemplate(){return{name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[getFont(["latin","Calibri Light",void 0,"020F0302020204030204"]),getFont(["ea",""]),getFont(["cs",""]),getFont(["font","\u6E38\u30B4\u30B7\u30C3\u30AF Light","Jpan"]),getFont(["font","\uB9D1\uC740 \uACE0\uB515","Hang"]),getFont(["font","\u7B49\u7EBF Light","Hans"]),getFont(["font","\u65B0\u7D30\u660E\u9AD4","Hant"]),getFont(["font","Times New Roman","Arab"]),getFont(["font","Times New Roman","Hebr"]),getFont(["font","Tahoma","Thai"]),getFont(["font","Nyala","Ethi"]),getFont(["font","Vrinda","Beng"]),getFont(["font","Shruti","Gujr"]),getFont(["font","MoolBoran","Khmr"]),getFont(["font","Tunga","Knda"]),getFont(["font","Raavi","Guru"]),getFont(["font","Euphemia","Cans"]),getFont(["font","Plantagenet Cherokee","Cher"]),getFont(["font","Microsoft Yi Baiti","Yiii"]),getFont(["font","Microsoft Himalaya","Tibt"]),getFont(["font","MV Boli","Thaa"]),getFont(["font","Mangal","Deva"]),getFont(["font","Gautami","Telu"]),getFont(["font","Latha","Taml"]),getFont(["font","Estrangelo Edessa","Syrc"]),getFont(["font","Kalinga","Orya"]),getFont(["font","Kartika","Mlym"]),getFont(["font","DokChampa","Laoo"]),getFont(["font","Iskoola Pota","Sinh"]),getFont(["font","Mongolian Baiti","Mong"]),getFont(["font","Times New Roman","Viet"]),getFont(["font","Microsoft Uighur","Uigh"]),getFont(["font","Sylfaen","Geor"]),getFont(["font","Arial","Armn"]),getFont(["font","Leelawadee UI","Bugi"]),getFont(["font","Microsoft JhengHei","Bopo"]),getFont(["font","Javanese Text","Java"]),getFont(["font","Segoe UI","Lisu"]),getFont(["font","Myanmar Text","Mymr"]),getFont(["font","Ebrima","Nkoo"]),getFont(["font","Nirmala UI","Olck"]),getFont(["font","Ebrima","Osma"]),getFont(["font","Phagspa","Phag"]),getFont(["font","Estrangelo Edessa","Syrn"]),getFont(["font","Estrangelo Edessa","Syrj"]),getFont(["font","Estrangelo Edessa","Syre"]),getFont(["font","Nirmala UI","Sora"]),getFont(["font","Microsoft Tai Le","Tale"]),getFont(["font","Microsoft New Tai Lue","Talu"]),getFont(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[getFont(["latin","Calibri",void 0,"020F0502020204030204"]),getFont(["ea",""]),getFont(["cs",""]),getFont(["font","\u6E38\u30B4\u30B7\u30C3\u30AF","Jpan"]),getFont(["font","\uB9D1\uC740 \uACE0\uB515","Hang"]),getFont(["font","\u7B49\u7EBF","Hans"]),getFont(["font","\u65B0\u7D30\u660E\u9AD4","Hant"]),getFont(["font","Arial","Arab"]),getFont(["font","Arial","Hebr"]),getFont(["font","Tahoma","Thai"]),getFont(["font","Nyala","Ethi"]),getFont(["font","Vrinda","Beng"]),getFont(["font","Shruti","Gujr"]),getFont(["font","DaunPenh","Khmr"]),getFont(["font","Tunga","Knda"]),getFont(["font","Raavi","Guru"]),getFont(["font","Euphemia","Cans"]),getFont(["font","Plantagenet Cherokee","Cher"]),getFont(["font","Microsoft Yi Baiti","Yiii"]),getFont(["font","Microsoft Himalaya","Tibt"]),getFont(["font","MV Boli","Thaa"]),getFont(["font","Mangal","Deva"]),getFont(["font","Gautami","Telu"]),getFont(["font","Latha","Taml"]),getFont(["font","Estrangelo Edessa","Syrc"]),getFont(["font","Kalinga","Orya"]),getFont(["font","Kartika","Mlym"]),getFont(["font","DokChampa","Laoo"]),getFont(["font","Iskoola Pota","Sinh"]),getFont(["font","Mongolian Baiti","Mong"]),getFont(["font","Arial","Viet"]),getFont(["font","Microsoft Uighur","Uigh"]),getFont(["font","Sylfaen","Geor"]),getFont(["font","Arial","Armn"]),getFont(["font","Leelawadee UI","Bugi"]),getFont(["font","Microsoft JhengHei","Bopo"]),getFont(["font","Javanese Text","Java"]),getFont(["font","Segoe UI","Lisu"]),getFont(["font","Myanmar Text","Mymr"]),getFont(["font","Ebrima","Nkoo"]),getFont(["font","Nirmala UI","Olck"]),getFont(["font","Ebrima","Osma"]),getFont(["font","Phagspa","Phag"]),getFont(["font","Estrangelo Edessa","Syrn"]),getFont(["font","Estrangelo Edessa","Syrj"]),getFont(["font","Estrangelo Edessa","Syre"]),getFont(["font","Nirmala UI","Sora"]),getFont(["font","Microsoft Tai Le","Tale"]),getFont(["font","Microsoft New Tai Lue","Talu"]),getFont(["font","Ebrima","Tfng"])]}]}}},fontScheme_default=fontScheme,getPropertyVal=(e,t,r)=>({name:`a:${e}`,properties:{rawMap:{val:t}},children:r}),getGs=e=>{const[t,r,a,o,n,s]=e,i=[];return i.push(getPropertyVal("satMod",a)),o&&i.push(getPropertyVal("lumMod",o)),n&&i.push(getPropertyVal("tint",n)),s&&i.push(getPropertyVal("shade",s)),{name:"a:gs",properties:{rawMap:{pos:t}},children:[{name:"a:schemeClr",properties:{rawMap:{val:r}},children:i}]}},getSolidFill=(e,t)=>({name:"a:solidFill",children:[getPropertyVal("schemeClr",e,t)]}),getGradFill=e=>{const[t,r,a,o,n]=e,[s,i]=n;return{name:"a:gradFill",properties:{rawMap:{rotWithShape:t}},children:[{name:"a:gsLst",children:[getGs(r),getGs(a),getGs(o)]},{name:"a:lin",properties:{rawMap:{ang:s,scaled:i}}}]}},getLine=e=>{const[t,r,a,o]=e;return{name:"a:ln",properties:{rawMap:{w:t,cap:r,cmpd:a,algn:o}},children:[getSolidFill("phClr"),getPropertyVal("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},getEffectStyle=e=>{const t=[];if(e){const[r,a,o,n,s]=e;t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:r,dist:a,dir:o,algn:n,rotWithShape:s}},children:[getPropertyVal("srgbClr","000000",[getPropertyVal("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},getFillStyleList=()=>({name:"a:fillStyleLst",children:[getSolidFill("phClr"),getGradFill(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),getGradFill(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]}),getLineStyleList=()=>({name:"a:lnStyleLst",children:[getLine(["6350","flat","sng","ctr"]),getLine(["12700","flat","sng","ctr"]),getLine(["19050","flat","sng","ctr"])]}),getEffectStyleList=()=>({name:"a:effectStyleLst",children:[getEffectStyle(),getEffectStyle(),getEffectStyle(["57150","19050","5400000","ctr","0"])]}),getBgFillStyleList=()=>({name:"a:bgFillStyleLst",children:[getSolidFill("phClr"),getSolidFill("phClr",[getPropertyVal("tint","95000"),getPropertyVal("satMod","170000")]),getGradFill(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}),formatScheme={getTemplate(){return{name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[getFillStyleList(),getLineStyleList(),getEffectStyleList(),getBgFillStyleList()]}}},formatScheme_default=formatScheme,themeElements={getTemplate(){return{name:"a:themeElements",children:[colorScheme_default.getTemplate(),fontScheme_default.getTemplate(),formatScheme_default.getTemplate()]}}},themeElements_default=themeElements,officeTheme={getTemplate(){return{name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[themeElements_default.getTemplate(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]}}},office_default=officeTheme,getShapeLayout=()=>({name:"o:shapelayout",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}]},children:[{name:"o:idmap",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}],rawMap:{data:"1"}}}]}),getStroke=()=>({name:"v:stroke",properties:{rawMap:{joinstyle:"miter"}}}),getFormulas=e=>({name:"v:formulas",children:e.map(t=>({name:"v:f",properties:{rawMap:{eqn:t}}}))}),getPath=()=>({name:"v:path",properties:{prefixedAttributes:[{prefix:"o:",map:{connecttype:"rect",extrusionok:"f"}}],rawMap:{gradientshapeok:"t"}}}),getLock=e=>{const{aspectratio:t,rotation:r}=e||{},a={};return t&&(a.aspectratio="t"),r&&(a.rotation="t"),{name:"o:lock",properties:{prefixedAttributes:[{prefix:"v:",map:{ext:"edit"}}],rawMap:a}}};function mapNumber(e,t,r,a,o){return(e-t)/(r-t)*(o-a)+a}var getImageData=(e,t)=>{let r;const{recolor:a,brightness:o,contrast:n,id:s}=e;if(a&&(r={},(a==="Washout"||a==="Grayscale")&&(r.gain="19661f",r.blacklevel="22938f"),(a==="Black & White"||a==="Grayscale")&&(r.grayscale="t",a==="Black & White"&&(r.bilevel="t"))),!a||a==="Grayscale"){if(r||(r={}),n!=null&&n!==50){let i="1";n>=0&&(n<50?i=String(n/50):n<100?i=String(50/(100-n)):n===100&&(i="2147483647f")),r.gain=i}o!=null&&o!==50&&(r.blacklevel=mapNumber(o,0,100,-.5,.5).toString())}return{name:"v:imagedata",properties:{prefixedAttributes:[{prefix:"o:",map:{relid:`rId${t}`,title:s}}],rawMap:r}}},getShapeType=()=>{const e=["if lineDrawn pixelLineWidth 0","sum @0 1 0","sum 0 0 @1","prod @2 1 2","prod @3 21600 pixelWidth","prod @3 21600 pixelHeight","sum @0 0 1","prod @6 1 2","prod @7 21600 pixelWidth","sum @8 21600 0","prod @7 21600 pixelHeight","sum @10 21600 0"];return{name:"v:shapetype",properties:{prefixedAttributes:[{prefix:"o:",map:{spt:"75",preferrelative:"t"}}],rawMap:{coordsize:"21600,21600",filled:"f",id:"_x0000_t75",path:"m@4@5l@4@11@9@11@9@5xe",stroked:"f"}},children:[getStroke(),getFormulas(e),getPath(),getLock({aspectratio:!0})]}},pixelToPoint=e=>Math.floor((e??0)*.74999943307122),getShape=(e,t)=>{const{width:r=0,height:a=0,altText:o}=e,n=pixelToPoint(r),s=pixelToPoint(a);return{name:"v:shape",properties:{rawMap:{id:e.headerFooterPosition,"o:spid":"_x0000_s1025",style:`position: absolute; margin-left: 0; margin-top: 10in; margin-bottom: 0; margin-right: 0; width: ${n}pt; height: ${s}pt; z-index: ${t+1}`,type:"#_x0000_t75",alt:o}},children:[getImageData(e,t+1),getLock({rotation:!0})]}},vmlDrawingFactory={getTemplate(e){const t=ExcelXlsxFactory.worksheetHeaderFooterImages.get(e.sheetIndex)||[],r=[getShapeLayout(),getShapeType(),...t.map((a,o)=>getShape(a,o))];return{name:"xml",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{v:"urn:schemas-microsoft-com:vml",o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel"}}]},children:r}}},vmlDrawing_default=vmlDrawingFactory,sheetFactory={getTemplate(e,t){const r=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:r,"r:id":`rId${r}`}}}}},sheet_default=sheetFactory,sheetsFactory={getTemplate(e){return{name:"sheets",children:e.map((t,r)=>sheet_default.getTemplate(t,r))}}},sheets_default=sheetsFactory,workbookFactory={getTemplate(e,t){return{name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[{name:"bookViews",children:[{name:"workbookView",properties:{rawMap:{activeTab:t}}}]},sheets_default.getTemplate(e)]}}},workbook_default=workbookFactory,import_core4=require("@ag-grid-community/core"),getExcelCellWidth=e=>Math.ceil((e-12)/7+1),columnFactory={getTemplate(e){const{min:t,max:r,outlineLevel:a,s:o,width:n,hidden:s,bestFit:i}=e;let l=1,p="0";return n>1&&(l=getExcelCellWidth(n),p="1"),{name:"col",properties:{rawMap:{min:t,max:r,outlineLevel:a??void 0,width:l,style:o,hidden:s?"1":"0",bestFit:i?"1":"0",customWidth:p}}}}},column_default=columnFactory,mergeCellFactory={getTemplate(e){return{name:"mergeCell",properties:{rawMap:{ref:e}}}}},mergeCell_default=mergeCellFactory,import_core3=require("@ag-grid-community/core"),convertLegacyType=e=>{const t=e.charAt(0).toLowerCase();return t==="s"?"inlineStr":t},cellFactory={getTemplate(e,t,r){const{ref:a,data:o,styleId:n}=e,{type:s,value:i}=o||{type:"empty",value:null};let l=s;s==="f"?l="str":s.charAt(0)===s.charAt(0).toUpperCase()&&(l=convertLegacyType(s));const p={name:"c",properties:{rawMap:{r:a,t:l==="empty"?void 0:l,s:n?getStyleId(n,r):void 0}}};if(l==="empty")return p;let c;return l==="str"&&s==="f"?c=[{name:"f",textNode:(0,import_core3._escapeString)(replaceInvisibleCharacters(i),!1)}]:l==="inlineStr"?c=[{name:"is",children:[{name:"t",textNode:(0,import_core3._escapeString)(replaceInvisibleCharacters(i),!1)}]}]:c=[{name:"v",textNode:i}],Object.assign({},p,{children:c})}},cell_default=cellFactory,addEmptyCells=(e,t)=>{const r=[];let a=0;for(let o=0;o<e.length;o++){const n=e[o];n.mergeAcross&&(r.push({pos:o,excelPos:a}),a+=n.mergeAcross),a++}if(r.length)for(let o=r.length-1;o>=0;o--){const n=[],s=e[r[o].pos];for(let i=1;i<=s.mergeAcross;i++)n.push({ref:`${getExcelColumnName(r[o].excelPos+1+i)}${t+1}`,styleId:s.styleId,data:{type:"empty",value:null}});n.length&&e.splice(r[o].pos+1,0,...n)}},shouldDisplayCell=e=>e.data?.value!==""||e.styleId!==void 0,rowFactory={getTemplate(e,t,r){const{collapsed:a,hidden:o,height:n,outlineLevel:s,cells:i=[]}=e;addEmptyCells(i,t);const l=i.filter(shouldDisplayCell).map((p,c)=>cell_default.getTemplate(p,c,r));return{name:"row",properties:{rawMap:{r:t+1,collapsed:a?"1":"0",hidden:o?"1":"0",ht:n,customHeight:n!=null?"1":"0",spans:"1:1",outlineLevel:s||void 0}},children:l}}},row_default=rowFactory,getMergedCellsAndAddColumnGroups=(e,t,r)=>{const a=[],o=[];e.forEach((i,l)=>{const p=i.cells;let c=0,m;p.forEach((h,u)=>{const d=u+c+1,f=getExcelColumnName(d),x=l+1;if(h.mergeAcross){c+=h.mergeAcross;const v=getExcelColumnName(u+c+1);a.push(`${f}${x}:${v}${x}`)}t[d-1]||(t[d-1]={});const{collapsibleRanges:g}=h;g&&g.forEach(v=>{o.push([d+v[0],d+v[1]])}),m=t[d-1],m.min=d,m.max=d,h.ref=`${f}${x}`})}),o.sort((i,l)=>i[0]!==l[0]?i[0]-l[0]:l[1]-i[1]);const n=new Map,s=new Map;return o.filter(i=>{const l=i.toString();return n.get(l)?!1:(n.set(l,!0),!0)}).forEach(i=>{const l=t.find(c=>c.min==i[0]&&c.max==i[1]),p=s.get(i[0]);t.push({min:i[0],max:i[1],outlineLevel:r?void 0:p||1,width:(l||{width:100}).width}),s.set(i[0],(p||0)+1)}),a},getPageOrientation=e=>!e||e!=="Portrait"&&e!=="Landscape"?"portrait":e.toLocaleLowerCase(),getPageSize=e=>{if(e==null)return 1;const r=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return r===-1?1:r+1},replaceHeaderFooterTokens=e=>{const t={"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F","&[Picture]":"&G"};return(0,import_core4._iterateObject)(t,(r,a)=>{e=e.replace(r,a)}),e},getHeaderPosition=e=>e==="Center"?"C":e==="Right"?"R":"L",applyHeaderFontStyle=(e,t)=>(t&&(e+="&amp;&quot;",e+=t.fontName||"Calibri",t.bold!==t.italic?e+=t.bold?",Bold":",Italic":t.bold?e+=",Bold Italic":e+=",Regular",e+="&quot;",t.size&&(e+=`&amp;${t.size}`),t.strikeThrough&&(e+="&amp;S"),t.underline&&(e+=`&amp;${t.underline==="Double"?"E":"U"}`),t.color&&(e+=`&amp;K${t.color.replace("#","").toUpperCase()}`)),e),processHeaderFooterContent=(e,t,r)=>e.reduce((a,o,n)=>{const s=getHeaderPosition(o.position),i=applyHeaderFontStyle(`${a}&amp;${s}`,o.font),l=["Left","Center","Right"];o.position||(o.position=l[n]);const{image:p}=o;if(o.value==="&[Picture]"&&p){const c=`${s}${t}${r}`;ExcelXlsxFactory.addHeaderFooterImageToMap(p,c)}return`${i}${(0,import_core4._escapeString)(replaceHeaderFooterTokens(o.value))}`},""),buildHeaderFooter=e=>{const t=["all","first","even"],r=[];return t.forEach(a=>{const o=e[a],n=a==="all"?"odd":a;if(o)for(const[s,i]of Object.entries(o)){const l=`${s.charAt(0).toUpperCase()}${s.slice(1)}`,p=s[0].toUpperCase();if(i){const c=a==="all"?"":a.toUpperCase();r.push({name:`${n}${l}`,properties:{rawMap:{"xml:space":"preserve"}},textNode:processHeaderFooterContent(i,p,c)})}}}),r},addColumns=e=>t=>(e.length&&t.children.push({name:"cols",children:e.map(r=>column_default.getTemplate(r))}),t),addSheetData=(e,t)=>r=>(e.length&&r.children.push({name:"sheetData",children:e.map((a,o)=>row_default.getTemplate(a,o,t))}),r),addMergeCells=e=>t=>(e.length&&t.children.push({name:"mergeCells",properties:{rawMap:{count:e.length}},children:e.map(r=>mergeCell_default.getTemplate(r))}),t),addPageMargins=e=>t=>{const{top:r=.75,right:a=.7,bottom:o=.75,left:n=.7,header:s=.3,footer:i=.3}=e;return t.children.push({name:"pageMargins",properties:{rawMap:{bottom:o,footer:i,header:s,left:n,right:a,top:r}}}),t},addPageSetup=e=>t=>(e&&t.children.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:getPageOrientation(e.orientation),paperSize:getPageSize(e.pageSize)}}}),t),addHeaderFooter=e=>t=>{if(!e)return t;const r=e.first!=null?1:0,a=e.even!=null?1:0;return t.children.push({name:"headerFooter",properties:{rawMap:{differentFirst:r,differentOddEven:a}},children:buildHeaderFooter(e)}),t},addExcelTableRel=e=>t=>(e&&t.children.push({name:"tableParts",properties:{rawMap:{count:"1"}},children:[{name:"tablePart",properties:{rawMap:{"r:id":`rId${++t.rIdCounter}`}}}]}),t),addDrawingRel=e=>t=>(ExcelXlsxFactory.worksheetImages.get(e)?.length&&t.children.push({name:"drawing",properties:{rawMap:{"r:id":`rId${++t.rIdCounter}`}}}),t),addVmlDrawingRel=e=>t=>(ExcelXlsxFactory.worksheetHeaderFooterImages.get(e)&&t.children.push({name:"legacyDrawingHF",properties:{rawMap:{"r:id":`rId${++t.rIdCounter}`}}}),t),getPane=(e=0,t=0)=>{const r=e>0||t>0;return r?[{name:"pane",properties:{rawMap:{state:r?"frozen":void 0,topLeftCell:r?`${getExcelColumnName(e+1)}${t+1}`:void 0,xSplit:e===0?void 0:e,ySplit:t===0?void 0:t}}}]:void 0},addSheetViews=(e=!1,t,r)=>a=>(a.children.push({name:"sheetViews",children:[{name:"sheetView",properties:{rawMap:{rightToLeft:e===!0?"1":"0",workbookViewId:"0"}},children:getPane(t,r)}]}),a),addSheetPr=()=>e=>(e.children.push({name:"sheetPr",children:[{name:"outlinePr",properties:{rawMap:{summaryBelow:0}}}]}),e),addSheetFormatPr=e=>t=>{const r=e.reduce((a,o)=>o.outlineLevel&&o.outlineLevel>a?o.outlineLevel:a,0);return t.children.push({name:"sheetFormatPr",properties:{rawMap:{baseColWidth:10,defaultRowHeight:16,outlineLevelRow:r||void 0}}}),t},worksheetFactory={getTemplate(e){const{worksheet:t,currentSheet:r,config:a}=e,{margins:o={},pageSetup:n,headerFooterConfig:s,suppressColumnOutline:i,rightToLeft:l,frozenRowCount:p,frozenColumnCount:c}=a,{table:m}=t,{rows:h,columns:u}=m,d=u&&u.length?getMergedCellsAndAddColumnGroups(h,u,!!i):[],{worksheetDataTables:f}=ExcelXlsxFactory,x=f.get(r),g=(0,import_core4._compose)(addSheetPr(),addSheetViews(l,c,p),addSheetFormatPr(h),addColumns(u),addSheetData(h,r+1),addMergeCells(d),addPageMargins(o),addPageSetup(n),addHeaderFooter(s),addDrawingRel(r),addVmlDrawingRel(r),addExcelTableRel(x)),{children:v}=g({children:[],rIdCounter:0});return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:v}}},worksheet_default=worksheetFactory,_ExcelXlsxFactory=class b{static createExcel(t,r,a){this.addSheetName(r),registerStyles(t,this.sheetNames.length);const o=Object.assign({},a);return a.exportAsExcelTable&&(a.columnModel.isPivotActive()&&(this.showExcelTableNonCompatibleFeaturesWarning("pivot mode"),o.exportAsExcelTable=!1),a.gos.get("masterDetail")&&(this.showExcelTableNonCompatibleFeaturesWarning("master/detail"),o.exportAsExcelTable=!1)),this.processTableConfig(r,o),this.createWorksheet(r,o)}static showExcelTableNonCompatibleFeaturesWarning(t){(0,import_core5._warnOnce)(`Excel table export does not work with ${t}. The exported Excel file will not contain any Excel tables.
Please turn off ${t} to enable Excel table exports.`)}static getTableNameFromIndex(t){return`table${t+1}`}static getSanitizedTableName(t){return t.replace(/^[^a-zA-Z_]+/,"_").replace(/\s/g,"_").replace(/[^a-zA-Z0-9_]/g,"_")}static addTableToSheet(t,r){if(this.worksheetDataTables.has(t)){(0,import_core5._warnOnce)("Unable to add data table to Excel sheet: A table already exists.");return}this.worksheetDataTables.set(t,r)}static processTableConfig(t,r){if(!r.exportAsExcelTable)return;const a=typeof r.exportAsExcelTable=="boolean"?{}:r.exportAsExcelTable,{name:o,showColumnStripes:n,showRowStripes:s,showFilterButton:i,highlightFirstColumn:l,highlightLastColumn:p}=a,c=this.getSanitizedTableName(o||b.defaultTableDisplayName),m=this.sheetNames.length-1,{table:h}=t,{rows:u,columns:d}=h,f=r.columnModel.getHeaderRowCount(),x=f-1,g=u.length,v=d.length,w=[],y=[];for(let C=0;C<v;C++){const T=d[C];w.push(T.displayName||""),y.push(i==="match"||i===void 0?T.filterAllowed??!1:i)}if(!w||!w.length||!g||!c){(0,import_core5._warnOnce)("Unable to add data table to Excel sheet: Missing required parameters.");return}this.addTableToSheet(m,{name:this.getTableNameFromIndex(m),displayName:c,columns:w,showFilterButtons:y,headerRowIndex:x,rowCount:g-f,showRowStripes:s??!0,showColumnStripes:n??!1,highlightFirstColumn:l??!1,highlightLastColumn:p??!1})}static addHeaderFooterImageToMap(t,r){const a=this.sheetNames.length-1,o=t;o.headerFooterPosition=r,this.buildImageMap({imageToAdd:o,idx:a});let n=this.worksheetHeaderFooterImages.get(a);n||(n=[],this.worksheetHeaderFooterImages.set(a,n)),n.find(s=>s.id===t.id)||n.push(t)}static addBodyImageToMap(t,r,a,o,n){const s=this.sheetNames.length,{row:i,column:l}=t.position||{},p=t;o&&(r!=null&&a!=null&&(!i||!l)&&(t.position||(t.position={}),t.position=Object.assign({},t.position,{row:r,column:o.indexOf(a)+1})),setExcelImageTotalWidth(p,o),setExcelImageTotalHeight(p,n)),this.buildImageMap({imageToAdd:p,idx:s});let c=this.worksheetImageIds.get(s);c||(c=new Map,this.worksheetImageIds.set(s,c));const m=this.worksheetImages.get(s);m?m.push(p):this.worksheetImages.set(s,[p]),c.get(t.id)||c.set(t.id,{index:c.size,type:t.imageType})}static buildImageMap(t){const{imageToAdd:r,idx:a}=t,o=this.images.get(r.id);if(o){const n=o.find(s=>s.sheetId===a);n?n.image.push(r):o.push({sheetId:a,image:[r]})}else this.images.set(r.id,[{sheetId:a,image:[r]}]),this.workbookImageIds.set(r.id,{type:r.imageType,index:this.workbookImageIds.size})}static addSheetName(t){const r=(0,import_core5._escapeString)(t.name)||"";let a="";for(;this.sheetNames.indexOf(`${r}${a}`)!==-1;)a===""?a="_1":a=`_${parseInt(a.slice(1),10)+1}`;t.name=`${r}${a}`,this.sheetNames.push(t.name)}static getStringPosition(t){return this.sharedStrings.has(t)?this.sharedStrings.get(t):(this.sharedStrings.set(t,this.sharedStrings.size),this.sharedStrings.size-1)}static resetFactory(){this.sharedStrings=new Map,this.images=new Map,this.worksheetImages=new Map,this.worksheetHeaderFooterImages=new Map,this.workbookImageIds=new Map,this.worksheetImageIds=new Map,this.worksheetDataTables=new Map,this.sheetNames=[],this.factoryMode=import_core5.ExcelFactoryMode.SINGLE_SHEET}static createWorkbook(t){return createXmlPart(workbook_default.getTemplate(this.sheetNames,t))}static createStylesheet(t){return createXmlPart(stylesheet_default.getTemplate(t))}static createSharedStrings(){return createXmlPart(sharedStrings_default.getTemplate(this.sharedStrings))}static createCore(t){return createXmlPart(core_default.getTemplate(t))}static createContentTypes(t){return createXmlPart(contentTypes_default.getTemplate(t))}static createRels(){const t=relationships_default.getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return createXmlPart(t)}static createTheme(){return createXmlPart(office_default.getTemplate())}static createTable(t,r){return createXmlPart(table_default.getTemplate(t,r))}static createWorkbookRels(t){const r=new Array(t).fill(void 0).map((o,n)=>({Id:`rId${n+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:`worksheets/sheet${n+1}.xml`})),a=relationships_default.getTemplate([...r,{Id:`rId${t+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:`rId${t+2}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:`rId${t+3}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}]);return createXmlPart(a)}static createDrawing(t){return createXmlPart(drawing_default.getTemplate({sheetIndex:t}))}static createDrawingRel(t){const r=this.worksheetImageIds.get(t)||[],a=[];for(const[o,n]of r){const{index:s,type:i}=n;a.push({Id:`rId${s+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${this.workbookImageIds.get(o).index+1}.${_normaliseImageExtension(i)}`})}return createXmlPart(relationships_default.getTemplate(a))}static createVmlDrawing(t){return createXmlPart(vmlDrawing_default.getTemplate({sheetIndex:t}),!0)}static createVmlDrawingRel(t){const r=this.worksheetHeaderFooterImages.get(t)||[],a=[];for(let o=0;o<r.length;o++){const n=r[o],s=this.workbookImageIds.get(n.id);if(!s)continue;const{index:i,type:l}=s;a.push({Id:`rId${o+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${i+1}.${_normaliseImageExtension(l)}`})}return createXmlPart(relationships_default.getTemplate(a))}static createRelationships({drawingIndex:t,vmlDrawingIndex:r,tableIndex:a}={}){if(t===void 0&&r===void 0&&a===void 0)return"";const o=[];t!=null&&o.push({Id:`rId${o.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/drawing${t+1}.xml`}),r!=null&&o.push({Id:`rId${o.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Target:`../drawings/vmlDrawing${r+1}.vml`}),a!=null&&o.push({Id:`rId${o.length+1}`,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",Target:`../tables/${this.getTableNameFromIndex(a)}.xml`});const n=relationships_default.getTemplate(o);return createXmlPart(n)}static createWorksheet(t,r){return createXmlPart(worksheet_default.getTemplate({worksheet:t,currentSheet:this.sheetNames.length-1,config:r}))}};_ExcelXlsxFactory.sharedStrings=new Map,_ExcelXlsxFactory.sheetNames=[],_ExcelXlsxFactory.images=new Map,_ExcelXlsxFactory.worksheetImages=new Map,_ExcelXlsxFactory.worksheetHeaderFooterImages=new Map,_ExcelXlsxFactory.workbookImageIds=new Map,_ExcelXlsxFactory.worksheetImageIds=new Map,_ExcelXlsxFactory.worksheetDataTables=new Map,_ExcelXlsxFactory.defaultTableDisplayName="AG-GRID-TABLE",_ExcelXlsxFactory.factoryMode=import_core5.ExcelFactoryMode.SINGLE_SHEET;var ExcelXlsxFactory=_ExcelXlsxFactory,ExcelSerializingSession=class extends import_csv_export2.BaseGridSerializingSession{constructor(e){super(e),this.mixedStyles={},this.mixedStyleCounter=0,this.rows=[],this.frozenRowCount=0,this.skipFrozenRows=!1,this.frozenColumnCount=0,this.skipFrozenColumns=!1,this.config=Object.assign({},e),this.stylesByIds={},this.config.baseExcelStyles.forEach(t=>{this.stylesByIds[t.id]=t}),this.excelStyles=[...this.config.baseExcelStyles,{id:"_quotePrefix",quotePrefix:1}]}addCustomContent(e){e.forEach(t=>{const r=this.rows.length+1;let a;!this.config.suppressRowOutline&&t.outlineLevel!=null&&(a=t.outlineLevel);const o={height:getHeightFromProperty(r,t.height||this.config.rowHeight),cells:(t.cells||[]).map((n,s)=>{const i=this.addImage(r,this.columnsToExport[s],n.data?.value);let l=null;n.styleId&&(l=typeof n.styleId=="string"?[n.styleId]:n.styleId);const p=this.getStyleId(l);if(i)return this.createCell(p,this.getDataTypeForValue(i.value),i.value==null?"":i.value);const c=n.data?.value??"",m=this.getDataTypeForValue(c);return n.mergeAcross?this.createMergedCell(p,m,c,n.mergeAcross):this.createCell(p,m,c)}),outlineLevel:a};t.collapsed!=null&&(o.collapsed=t.collapsed),t.hidden!=null&&(o.hidden=t.hidden),this.rows.push(o)})}onNewHeaderGroupingRow(){const e=[],{freezeRows:t,headerRowHeight:r}=this.config;return this.rows.push({cells:e,height:getHeightFromProperty(this.rows.length+1,r)}),t&&this.frozenRowCount++,{onColumn:(a,o,n,s,i)=>{const l=this.config.styleLinker({rowType:import_csv_export2.RowType.HEADER_GROUPING,rowIndex:1,value:`grouping-${o}`,columnGroup:a});e.push({...this.createMergedCell(this.getStyleId(l),this.getDataTypeForValue("string"),o,s),collapsibleRanges:i})}}}onNewHeaderRow(){const{freezeRows:e,headerRowHeight:t}=this.config;return e&&this.frozenRowCount++,this.onNewRow(this.onNewHeaderColumn,t)}onNewBodyRow(e){const{freezeRows:t,rowHeight:r}=this.config;this.skipFrozenRows||(t==="headersAndPinnedRows"&&e?.rowPinned==="top"?this.frozenRowCount++:typeof t=="function"?t({...this.gos.getGridCommonParams(),node:e})?this.frozenRowCount++:this.skipFrozenRows=!0:this.skipFrozenRows=!0);const a=this.onNewRow(this.onNewBodyColumn,r);return e&&this.addRowOutlineIfNecessary(e),a}prepare(e){super.prepare(e),this.columnsToExport=[...e],this.cols=e.map((t,r)=>this.convertColumnToExcel(t,r))}parse(){const e=this.rows.reduce((o,n)=>Math.max(o,n.cells.length),0);for(;this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));const{config:t}=this;let r;if(t.sheetName!=null){const{sheetName:o}=t,n=typeof o=="function"?o(this.gos.getGridCommonParams()):o;r=String(n).substring(0,31)}else r="ag-grid";const a={name:r,table:{columns:this.cols,rows:this.rows}};return this.createExcel(a)}addRowOutlineIfNecessary(e){const{gos:t,suppressRowOutline:r,rowGroupExpandState:a="expanded"}=this.config;if(t.get("groupHideOpenParents")||r||e.level==null)return;const n=e.footer?1:0,s=(0,import_core7._last)(this.rows),i=Math.min(e.level+n,7);if(s.outlineLevel=i,a==="expanded")return;const l=a==="collapsed";if(e.isExpandable()){const p=!l&&e.expanded;s.collapsed=!p}s.hidden=!!e.parent&&e.parent.level!==-1&&(l||this.isAnyParentCollapsed(e.parent))}isAnyParentCollapsed(e){for(;e&&e.level!==-1;){if(!e.expanded)return!0;e=e.parent}return!1}convertColumnToExcel(e,t){const r=this.config.columnWidth,o=(e?this.extractHeaderValue(e):void 0)??"",n=e?e.isFilterAllowed():!1;return r?typeof r=="number"?{width:r,displayName:o,filterAllowed:n}:{width:r({column:e,index:t}),displayName:o,filterAllowed:n}:e?{width:Math.max(e.getActualWidth(),75),displayName:o,filterAllowed:n}:{displayName:o,filterAllowed:n}}onNewHeaderColumn(e,t){return r=>{const a=this.extractHeaderValue(r),o=this.config.styleLinker({rowType:import_csv_export2.RowType.HEADER,rowIndex:e,value:a,column:r});t.push(this.createCell(this.getStyleId(o),this.getDataTypeForValue("string"),a))}}onNewBodyColumn(e,t){let r=0;const{freezeColumns:a,rightToLeft:o}=this.config;return(n,s,i)=>{if(r>0){r-=1;return}if(!this.skipFrozenColumns){const d=n.getPinned();a==="pinned"&&d&&(d===!0||d==="left")!==o?this.frozenColumnCount++:typeof a=="function"&&a({...this.gos.getGridCommonParams(),column:n})?this.frozenColumnCount++:this.skipFrozenColumns=!0}const{value:l,valueFormatted:p}=this.extractRowCellValue(n,s,e,"excel",i),c=this.config.styleLinker({rowType:import_csv_export2.RowType.BODY,rowIndex:e,value:l,column:n,node:i}),m=this.getStyleId(c),h=n.getColSpan(i),u=this.addImage(e,n,l);u?t.push(this.createCell(m,this.getDataTypeForValue(u.value),u.value==null?"":u.value)):h>1?(r=h-1,t.push(this.createMergedCell(m,this.getDataTypeForValue(l),l,h-1))):t.push(this.createCell(m,this.getDataTypeForValue(l),l,p))}}onNewRow(e,t){const r=[];return this.rows.push({cells:r,height:getHeightFromProperty(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,r)()}}createExcel(e){const{excelStyles:t,config:r}=this;return this.frozenColumnCount&&(r.frozenColumnCount=this.frozenColumnCount),this.frozenRowCount&&(r.frozenRowCount=this.frozenRowCount),ExcelXlsxFactory.createExcel(t,e,r)}getDataTypeForValue(e){return e===void 0?"empty":this.isNumerical(e)?"n":"s"}getTypeFromStyle(e,t){if(this.isFormula(t))return"f";if(e&&e.dataType)switch(e.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:(0,import_core7._warnOnce)(`Unrecognized data type for excel export [${e.id}.dataType=${e.dataType}]`)}return null}addImage(e,t,r){if(!this.config.addImageToCell)return;const a=this.config.addImageToCell(e,t,r);if(a)return ExcelXlsxFactory.addBodyImageToMap(a.image,e,t,this.columnsToExport,this.config.rowHeight),a}createCell(e,t,r,a){const o=this.getStyleById(e);!o?.dataType&&t==="s"&&a&&(r=a);const n=this.getTypeFromStyle(o,r)||t,{value:s,escaped:i}=this.getCellValue(n,r),l=[];return o&&l.push(e),i&&l.push("_quotePrefix"),e=this.getStyleId(l)||void 0,{styleId:e,data:{type:n,value:s}}}createMergedCell(e,t,r,a){const o=r??"";return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:t==="s"?ExcelXlsxFactory.getStringPosition(o).toString():r},mergeAcross:a}}getCellValue(e,t){let r=!1;if(t==null||e==="s"&&t==="")return{value:"",escaped:!1};if(e==="s")t&&t[0]==="'"&&(r=!0,t=t.slice(1)),t=ExcelXlsxFactory.getStringPosition(t).toString();else if(e==="f")t=t.slice(1);else if(e==="n"){const a=Number(t);isNaN(a)?t="":t!==""&&(t=a.toString())}return{value:t,escaped:r}}getStyleId(e){if(!e||!e.length)return null;if(e.length===1)return e[0];const t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID}deepCloneObject(e){return JSON.parse(JSON.stringify(e))}addNewMixedStyle(e){this.mixedStyleCounter+=1;const t=`mixedStyle${this.mixedStyleCounter}`,r={};for(const o of e)for(const n of this.excelStyles)n.id===o&&(0,import_core7._mergeDeep)(r,this.deepCloneObject(n));r.id=t,r.name=t;const a=e.join("-");this.mixedStyles[a]={excelID:t,key:a,result:r},this.excelStyles.push(r),this.stylesByIds[t]=r}isFormula(e){return e==null?!1:this.config.autoConvertFormulas&&e.toString().startsWith("=")}isNumerical(e){return typeof e=="bigint"?!0:isFinite(e)&&e!==""&&!isNaN(parseFloat(e))}getStyleById(e){return e==null?null:this.stylesByIds[e]||null}},createExcelXMLCoreFolderStructure=()=>{import_csv_export3.ZipContainer.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]);const{images:e}=ExcelXlsxFactory;if(!e.size)return;import_csv_export3.ZipContainer.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);let t=0;e.forEach(r=>{const a=r[0].image[0],{base64:o,imageType:n}=a;import_csv_export3.ZipContainer.addFile(`xl/media/image${++t}.${_normaliseImageExtension(n)}`,o,!0)})},createExcelXmlWorksheets=e=>{let t=0,r=0,a=0;const{images:o,worksheetDataTables:n,worksheetImages:s,worksheetHeaderFooterImages:i}=ExcelXlsxFactory;for(let l=0;l<e.length;l++){const p=e[l];import_csv_export3.ZipContainer.addFile(`xl/worksheets/sheet${l+1}.xml`,p,!1);const c=o.size>0&&s.has(l),m=n.size>0&&n.has(l),h=o.size&&i.has(l);if(!c&&!m&&!h)continue;let u,d,f;c&&(createExcelXmlDrawings(l,t),d=t,t++),h&&(createExcelVmlDrawings(l,r),f=r,r++),m&&(u=a++);const x=`xl/worksheets/_rels/sheet${l+1}.xml.rels`;import_csv_export3.ZipContainer.addFile(x,ExcelXlsxFactory.createRelationships({tableIndex:u,drawingIndex:d,vmlDrawingIndex:f}))}},createExcelXmlDrawings=(e,t)=>{const r="xl/drawings",a=`${r}/drawing${t+1}.xml`,o=`${r}/_rels/drawing${t+1}.xml.rels`;import_csv_export3.ZipContainer.addFile(o,ExcelXlsxFactory.createDrawingRel(e)),import_csv_export3.ZipContainer.addFile(a,ExcelXlsxFactory.createDrawing(e))},createExcelVmlDrawings=(e,t)=>{const r="xl/drawings",a=`${r}/vmlDrawing${t+1}.vml`,o=`${r}/_rels/vmlDrawing${t+1}.vml.rels`;import_csv_export3.ZipContainer.addFile(a,ExcelXlsxFactory.createVmlDrawing(e)),import_csv_export3.ZipContainer.addFile(o,ExcelXlsxFactory.createVmlDrawingRel(e))},createExcelXmlTables=()=>{const{worksheetDataTables:e}=ExcelXlsxFactory,t=e,r=Array.from(t.keys());for(let a=0;a<r.length;a++){const o=r[a],n=t.get(o);n&&import_csv_export3.ZipContainer.addFile(`xl/tables/${n.name}.xml`,ExcelXlsxFactory.createTable(n,a))}},createExcelXmlCoreSheets=(e,t,r,a)=>{import_csv_export3.ZipContainer.addFile("xl/workbook.xml",ExcelXlsxFactory.createWorkbook(a)),import_csv_export3.ZipContainer.addFile("xl/styles.xml",ExcelXlsxFactory.createStylesheet(e)),import_csv_export3.ZipContainer.addFile("xl/sharedStrings.xml",ExcelXlsxFactory.createSharedStrings()),import_csv_export3.ZipContainer.addFile("xl/theme/theme1.xml",ExcelXlsxFactory.createTheme()),import_csv_export3.ZipContainer.addFile("xl/_rels/workbook.xml.rels",ExcelXlsxFactory.createWorkbookRels(r)),import_csv_export3.ZipContainer.addFile("docProps/core.xml",ExcelXlsxFactory.createCore(t)),import_csv_export3.ZipContainer.addFile("[Content_Types].xml",ExcelXlsxFactory.createContentTypes(r)),import_csv_export3.ZipContainer.addFile("_rels/.rels",ExcelXlsxFactory.createRels())},createExcelFileForExcel=(e,t={})=>{if(!e||e.length===0)return(0,import_core8._warnOnce)("Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty."),ExcelXlsxFactory.resetFactory(),!1;const{fontSize:r=11,author:a="AG Grid",activeTab:o=0}=t,n=e.length,s=Math.max(Math.min(o,n-1),0);return createExcelXMLCoreFolderStructure(),createExcelXmlTables(),createExcelXmlWorksheets(e),createExcelXmlCoreSheets(r,a,n,s),ExcelXlsxFactory.resetFactory(),!0},getMultipleSheetsAsExcelCompressed=e=>{const{data:t,fontSize:r,author:a,activeSheetIndex:o}=e,n=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return createExcelFileForExcel(t,{author:a,fontSize:r,activeTab:o})?import_csv_export3.ZipContainer.getZipFile(n):Promise.resolve(void 0)},getMultipleSheetsAsExcel=e=>{const{data:t,fontSize:r,author:a,activeSheetIndex:o}=e,n=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";if(createExcelFileForExcel(t,{author:a,fontSize:r,activeTab:o}))return import_csv_export3.ZipContainer.getUncompressedZipFile(n)},exportMultipleSheetsAsExcel=e=>{const{fileName:t="export.xlsx"}=e;getMultipleSheetsAsExcelCompressed(e).then(r=>{if(r){const a=typeof t=="function"?t():t;import_csv_export3.Downloader.download(a,r)}})},ExcelCreator=class extends import_csv_export3.BaseCreator{constructor(){super(...arguments),this.beanName="excelCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.stylingService=e.stylingService,this.gridSerializer=e.gridSerializer,this.gos=e.gos}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultExcelExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){(0,import_core8._warnOnce)("Export cancelled. Export is not allowed as per your configuration.");return}const t=this.getMergedParams(e),a={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};this.packageCompressedFile(a).then(o=>{if(o){const{fileName:n}=t,s=typeof n=="function"?n(this.gos.getGridCommonParams()):n;import_csv_export3.Downloader.download(this.getFileName(s),o)}})}exportDataAsExcel(e){this.export(e)}getDataAsExcel(e){const t=this.getMergedParams(e),a={data:[this.getData(t)],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(a)}setFactoryMode(e){ExcelXlsxFactory.factoryMode=e}getFactoryMode(){return ExcelXlsxFactory.factoryMode}getSheetDataForExcel(e){const t=this.getMergedParams(e);return this.getData(t)}getMultipleSheetsAsExcel(e){return getMultipleSheetsAsExcel(e)}exportMultipleSheetsAsExcel(e){exportMultipleSheetsAsExcel(e)}getDefaultFileExtension(){return"xlsx"}createSerializingSession(e){const{columnModel:t,columnNameService:r,funcColsService:a,valueService:o,gos:n}=this,s={...e,columnModel:t,columnNameService:r,funcColsService:a,valueService:o,gos:n,suppressRowOutline:e.suppressRowOutline||e.skipRowGroups,headerRowHeight:e.headerRowHeight||e.rowHeight,baseExcelStyles:this.gos.get("excelStyles")||[],rightToLeft:e.rightToLeft??this.gos.get("enableRtl"),styleLinker:this.styleLinker.bind(this)};return new ExcelSerializingSession(s)}styleLinker(e){const{rowType:t,rowIndex:r,value:a,column:o,columnGroup:n,node:s}=e,i=t===import_csv_export3.RowType.HEADER,l=t===import_csv_export3.RowType.HEADER_GROUPING,p=i?o:n;let c=[];if(i||l)return c.push("header"),l&&c.push("headerGroup"),p&&(c=c.concat((0,import_core8._getHeaderClassesFromColDef)(p.getDefinition(),this.gos,o||null,n||null))),c;const m=this.gos.get("excelStyles"),h=["cell"];if(!m||!m.length)return h;const u=m.map(f=>f.id),d=o.getDefinition();return this.stylingService.processAllCellClasses(d,this.gos.addGridCommonParams({value:a,data:s.data,node:s,colDef:d,column:o,rowIndex:r}),f=>{u.indexOf(f)>-1&&h.push(f)}),h.sort((f,x)=>u.indexOf(f)<u.indexOf(x)?-1:1)}isExportSuppressed(){return this.gos.get("suppressExcelExport")}packageCompressedFile(e){return getMultipleSheetsAsExcelCompressed(e)}packageFile(e){return getMultipleSheetsAsExcel(e)}},import_core9=require("@ag-grid-community/core");function assertNotExcelMultiSheet(e){return e.excelCreator?.getFactoryMode()===import_core9.ExcelFactoryMode.MULTI_SHEET?((0,import_core9._warnOnce)("The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1):!0}function getDataAsExcel(e,t){if(assertNotExcelMultiSheet(e))return e.excelCreator?.getDataAsExcel(t)}function exportDataAsExcel(e,t){assertNotExcelMultiSheet(e)&&e.excelCreator?.exportDataAsExcel(t)}function getSheetDataForExcel(e,t){return e.excelCreator?.setFactoryMode(import_core9.ExcelFactoryMode.MULTI_SHEET),e.excelCreator?.getSheetDataForExcel(t)}function getMultipleSheetsAsExcel2(e,t){return e.excelCreator?.getMultipleSheetsAsExcel(t)}function exportMultipleSheetsAsExcel2(e,t){e.excelCreator?.exportMultipleSheetsAsExcel(t)}var VERSION="32.3.9",ExcelExportCoreModule=(0,import_core10._defineModule)({version:VERSION,moduleName:`${import_core10.ModuleNames.ExcelExportModule}-core`,beans:[ExcelCreator],dependantModules:[import_csv_export4._CsvExportCoreModule,import_core11.EnterpriseCoreModule]}),ExcelExportApiModule=(0,import_core10._defineModule)({version:VERSION,moduleName:`${import_core10.ModuleNames.ExcelExportModule}-api`,apiFunctions:{getDataAsExcel,exportDataAsExcel,getSheetDataForExcel,getMultipleSheetsAsExcel:getMultipleSheetsAsExcel2,exportMultipleSheetsAsExcel:exportMultipleSheetsAsExcel2},dependantModules:[ExcelExportCoreModule]}),ExcelExportModule=(0,import_core10._defineModule)({version:VERSION,moduleName:import_core10.ModuleNames.ExcelExportModule,dependantModules:[ExcelExportCoreModule,ExcelExportApiModule]});
